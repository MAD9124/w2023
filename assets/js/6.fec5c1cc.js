(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{296:function(t,s,a){t.exports=a.p+"assets/img/google_sign_in.5c9053a6.png"},297:function(t,s,a){t.exports=a.p+"assets/img/google_sign_up.28d49f6c.png"},298:function(t,s,a){t.exports=a.p+"assets/img/APIs_and_services.0b20fa07.png"},299:function(t,s,a){t.exports=a.p+"assets/img/create_project.1e3e6212.png"},300:function(t,s,a){t.exports=a.p+"assets/img/create_project_form.498aa5c9.png"},301:function(t,s,a){t.exports=a.p+"assets/img/google_oauth_consent01.d7f513e8.png"},302:function(t,s,a){t.exports=a.p+"assets/img/google_oauth_add_user.cd37d846.png"},303:function(t,s,a){t.exports=a.p+"assets/img/google_credentials01.70df21e3.png"},304:function(t,s,a){t.exports=a.p+"assets/img/google_credentials_success.677594d6.png"},305:function(t,s){t.exports="data:image/png;base64,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"},306:function(t,s,a){t.exports=a.p+"assets/img/dev_tools.f174a904.png"},307:function(t,s,a){t.exports=a.p+"assets/img/postman_headers.a4731e49.png"},419:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("WeekHeader",{attrs:{number:11,title:"Authentication With Passport"}}),t._v(" "),s("h2",{attrs:{id:"agenda"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#agenda"}},[t._v("#")]),t._v(" Agenda")]),t._v(" "),s("ul",[s("li",[t._v("AMA (10 mins)")]),t._v(" "),s("li",[t._v("What is Passport")]),t._v(" "),s("li",[t._v("Create a Google Application")]),t._v(" "),s("li",[t._v("Setting up Passport Application")]),t._v(" "),s("li",[t._v("Sessions")]),t._v(" "),s("li",[t._v("Locking Down Routes")]),t._v(" "),s("li",[t._v("Persisting our Session")]),t._v(" "),s("li",[t._v("Testing in Postman")])]),t._v(" "),s("h2",{attrs:{id:"ama-review"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ama-review"}},[t._v("#")]),t._v(" AMA / Review")]),t._v(" "),s("h2",{attrs:{id:"what-is-passport"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#what-is-passport"}},[t._v("#")]),t._v(" What is Passport?")]),t._v(" "),s("p",[t._v("Passport is authentication middleware for Node.js. Extremely flexible and modular, Passport can be unobtrusively dropped in to any Express-based web application. A comprehensive set of strategies support authentication using a username and password, Google, Facebook, Twitter, and more. Check out their website "),s("a",{attrs:{href:"https://www.passportjs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1),t._v(". We will be using "),s("a",{attrs:{href:"https://www.passportjs.org/packages/passport-google-oauth20/",target:"_blank",rel:"noopener noreferrer"}},[t._v("passport-google-oauth2.0"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"create-a-google-application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-a-google-application"}},[t._v("#")]),t._v(" Create a Google Application")]),t._v(" "),s("h3",{attrs:{id:"creating-your-google-account"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-your-google-account"}},[t._v("#")]),t._v(" Creating your Google Account")]),t._v(" "),s("p",[t._v("Before we can use passport to login via Google, we will need to create a Google application, and generate keys that we will share with Google, so they know who we are.")]),t._v(" "),s("p",[t._v("Begin the process by going to "),s("a",{attrs:{href:"https://console.developers.google.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google Developers Console"),s("OutboundLink")],1),t._v(", and creating a google account with your algonquincollege email.\n"),s("img",{attrs:{src:a(296),alt:"Sign In"}})]),t._v(" "),s("p",[t._v("You will need to provide your phone number for 2FA, as well as a few other details.")]),t._v(" "),s("p",[s("img",{attrs:{src:a(297),alt:"Sign Up"}})]),t._v(" "),s("p",[t._v("Once you are signed up and signed in, you should be able to get to this "),s("a",{attrs:{href:"https://console.cloud.google.com/projectselector2/apis/dashboard",target:"_blank",rel:"noopener noreferrer"}},[t._v("page"),s("OutboundLink")],1),t._v(":")]),t._v(" "),s("p",[s("img",{attrs:{src:a(298),alt:"API page"}})]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"creating-your-first-project"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-your-first-project"}},[t._v("#")]),t._v(" Creating your first project")]),t._v(" "),s("p",[t._v("Now we need to create a project.")]),t._v(" "),s("ul",[s("li",[t._v("click on the "),s("code",[t._v("Select a project")]),t._v(" dropdown at the top left of the page.\n"),s("img",{attrs:{src:a(299),alt:"Create project"}})]),t._v(" "),s("li",[t._v("name your project using your student number and week11\n"),s("img",{attrs:{src:a(300),alt:"Create project form"}})])]),t._v(" "),s("h3",{attrs:{id:"setting-up-the-oauth-consent-screen"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-the-oauth-consent-screen"}},[t._v("#")]),t._v(" Setting up the OAuth Consent Screen")]),t._v(" "),s("ul",[s("li",[t._v("Navigate to APIs & Services / Oauth consent screen")]),t._v(" "),s("li",[t._v("Select User Type External and click CREATE\n"),s("img",{attrs:{src:a(301),alt:"Oauth Consent Screen"}})]),t._v(" "),s("li",[t._v("Fill out the form with App name, User support email (your algonquin email), and Developer contact email (also you algonquin email)")])]),t._v(" "),s("p",[s("em",[t._v("The rest of the information can be skipped for now, but should be filled out in a non testing environment")])]),t._v(" "),s("ul",[s("li",[t._v("Add the scope "),s("code",[t._v("./auth/userinfo.profile")]),t._v(", we will get the user's name and email from google.")])]),t._v(" "),s("p",[s("em",[t._v("We will not be needing any sensitive scopes for this project")])]),t._v(" "),s("ul",[s("li",[t._v("Add test users. Only users on the list will be able to sign in to your app. Please add yourself and me "),s("code",[t._v("robillt@algonquincollege.com")]),t._v(" so I can sign in to your app!\n"),s("img",{attrs:{src:a(302),alt:"Oauth Consent Screen Users"}})]),t._v(" "),s("li",[t._v("Fill out the form with App name, User support email (your algonquin email), and Developer contact email (also you algonquin email)")]),t._v(" "),s("li",[t._v("Review all of your entries, and hit back to dashboard if it is all good.")])]),t._v(" "),s("h3",{attrs:{id:"creating-our-shared-credentials"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-our-shared-credentials"}},[t._v("#")]),t._v(" Creating our shared credentials")]),t._v(" "),s("p",[t._v("Google will need a way to connect requests coming from our node application to the application we are setting up in Google. We can do this using generated credentials.")]),t._v(" "),s("p",[s("img",{attrs:{src:a(303),alt:"Google Credntials dashboard"}})]),t._v(" "),s("ul",[s("li",[t._v("Navigate to APIs & Services / Credentials")]),t._v(" "),s("li",[t._v("Click Create Credentials, OAuth client ID")]),t._v(" "),s("li",[t._v("Fill out the form with Application type: "),s("code",[t._v("Web application")]),t._v(", name whatever you like, and add "),s("code",[t._v("http://localhost:3000")]),t._v(" as the authorized JavaScript origin, and "),s("code",[t._v("http://localhost:3001/auth/google/callback")]),t._v(" as the Authorized redirect URI")])]),t._v(" "),s("p",[s("em",[t._v("NOTE - You will have to tell google your production domains when you are ready to deploy. ex "),s("code",[t._v("https://example.ca")])])]),t._v(" "),s("ul",[s("li",[t._v("Once it is done you should see the following modal. Copy the client ID and Client Secret, and add it to your .env file\n"),s("img",{attrs:{src:a(304),alt:"Google Success"}}),t._v(" "),s("img",{attrs:{src:a(305),alt:"env"}})])]),t._v(" "),s("p",[s("em",[t._v("It is important to keep these safe. DO NOT COMMIT THEM TO GITHUB.\nI have deleted the credentials in the picture")])]),t._v(" "),s("h3",{attrs:{id:"we-are-all-set-with-google"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#we-are-all-set-with-google"}},[t._v("#")]),t._v(" We are all set with Google!")]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"setting-up-passport-application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-passport-application"}},[t._v("#")]),t._v(" Setting up Passport Application")]),t._v(" "),s("h3",{attrs:{id:"install-the-dependencies"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#install-the-dependencies"}},[t._v("#")]),t._v(" Install the dependencies")]),t._v(" "),s("p",[t._v("We will need to install our usual depencies, plus 3 new dependencies:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" express mongoose morgan passport passport-google-oauth2 express-session\n")])])]),s("p",[s("em",[t._v("NOTE more on express-session later")])]),t._v(" "),s("h3",{attrs:{id:"set-up-our-index-js-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#set-up-our-index-js-file"}},[t._v("#")]),t._v(" Set up our index.js file")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use strict'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dotenv/config'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" morgan "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'morgan'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("express"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("morgan")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'tiny'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\nres"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello, world!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("Server listening on port ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PORT")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"create-the-user-model"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-the-user-model"}},[t._v("#")]),t._v(" Create the User Model")]),t._v(" "),s("p",[t._v("In "),s("code",[t._v("src/models/User.js")]),t._v(", define the User schema and model. We will be getting the name and googleId from google.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"use strict"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Schema "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mongoose"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" UserSchema "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("required")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("googleId")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("required")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("timestamps")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nUserSchema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'toObject'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ret")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("ret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("model")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" UserSchema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"configure-the-strategy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-the-strategy"}},[t._v("#")]),t._v(" Configure the strategy")]),t._v(" "),s("p",[t._v("We will configure passport in its own file to keep it neat.")]),t._v(" "),s("p",[t._v("Begin by importing the required libraries and User Model")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// util/passport.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"use strict"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" GoogleStrategy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"passport-google-oauth20"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" passport "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"passport"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" User "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"../models/User"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GOOGLE_CLIENT_ID")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GOOGLE_CLIENT_SECRET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GOOGLE_CALLBACK_URL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Next, we tell passport to use the the GoogleStrategy, and configure it with our ids and urls.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("passport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("GoogleStrategy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Dont forget to import from process.env")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("clientID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GOOGLE_CLIENT_ID")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("clientSecret")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GOOGLE_CLIENT_SECRET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("callbackURL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GOOGLE_CALLBACK_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_accessToken"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _refreshToken"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cb")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// here, we will look up a user by the googleId, and either")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// create a new User if none exists, or")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// update the existing User, in case they changed their name in google.")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" User"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findOneAndUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("googleId")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("$set")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("displayName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("googleId")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// upsert is how we tell mongoose to UP-date the document or in-SERT a new one")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// don't forget to tell mongoose to return the updated document!")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("upsert")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("returnDocument")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'after'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Finally, passport needs to know how to serialize and deserialize the User.")]),t._v(" "),s("ul",[s("li",[t._v("Serializing the User takes it from its expanded state, and stores it how we want it in the session. The safest way to do this is by saving just the id.")]),t._v(" "),s("li",[t._v("Deserializing is the opposite, and will take the serialized version (in our case the id) and transform it back into the full User object.")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("passport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("serializeUser")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" done")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("done")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\npassport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("deserializeUser")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" done")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" User"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("done")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("done")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Now we will create our authentication routes. One will be the route to redirect to google, asking to login. The next is the route google will send its response to with either a success or an error depending on what happens with google.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// router/auth.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"use strict"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Router "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"express"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" passport "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"passport"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" authRouter "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Router")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// make sure to import the configuration we set up above")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"../util/passport"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this route will redirect the user to google")]),t._v("\nauthRouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/google"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  passport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("authenticate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"google"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("scope")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"profile"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this route will be hit by google once they are finished.")]),t._v("\nauthRouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/google/callback"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  passport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("authenticate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"google"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("failureRedirect")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/login"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("redirect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/test"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" authRouter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"sessions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sessions"}},[t._v("#")]),t._v(" Sessions")]),t._v(" "),s("p",[t._v("Because HTTP requests are stateless, we need a way to keep track of data between requests. Cookies and URL parameters are one way, but what about for data you don't want the client to know about?  This is where sessions come in. We store the data on the server with an id, and let the client only know the id for the session. We can then look it up again on the server and access the data.")]),t._v(" "),s("p",[t._v("Passport uses sessions to keep tracked of whether or not we have been signed in with google.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src/index.js")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("session")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("secret")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SESSION_SECRET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("resave")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("saveUninitialized")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Now we can initialize passport, and connect it to the session we set up.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("passport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initialize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("passport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("session")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("With everything set up correctly, passport will check the session on every request, and attach a user to the request if their is a successful login saved in the session.")]),t._v(" "),s("p",[t._v("We can test this out with a simple middleware.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("Note that it should log out user undefined initially. Once we go to /auth/google and sign in with google, we should see a user object logged out. We are in!")]),t._v(" "),s("h2",{attrs:{id:"locking-down-routes-with-middleware"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#locking-down-routes-with-middleware"}},[t._v("#")]),t._v(" Locking down routes with middleware")]),t._v(" "),s("p",[t._v("We now know that any request from a logged in user will have a user object attached to the request. We can leverage this to create a super simple middleware function call "),s("code",[t._v("isAuthenticated")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src/middleware/isAuthenticated.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use strict'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("isAuthenticated")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'You must be signed in to access this'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// NOTE if your error handler is set up, you can throw an UnAuthenticatedError here instead")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// throw new UnAuthenticatedError('You must be signed in to access this');")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" isAuthenticated\n")])])]),s("p",[t._v("Let's create a second route that you must be authenticated to see.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/private'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" isAuthenticated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'You are logged in!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"persisting-our-session"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#persisting-our-session"}},[t._v("#")]),t._v(" Persisting our Session")]),t._v(" "),s("p",[t._v("You may notice, and be quite frustrated, that every time our server restarts, we lose our session, and need to log in again. This is because the default session is stored in memory (just like we stored our student data in arrays).")]),t._v(" "),s("p",[t._v("The most popular way to save a session is using Redis, a quick and lightway database, but we will use "),s("code",[t._v("connect-mongo")]),t._v(" to save learning a whole new DB.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src/index.js")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// update our session object to look like this")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("session")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("store")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" MongoStore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mongoUrl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MONGO_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("secret")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SESSION_SECRET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("resave")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("saveUninitialized")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Thats it! Our session will now be stored in mongo, and will persist even after refreshing our server!")]),t._v(" "),s("h2",{attrs:{id:"testing-in-postman"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#testing-in-postman"}},[t._v("#")]),t._v(" Testing in Postman")]),t._v(" "),s("p",[t._v("How can we access private routes in postman? We can copy the session id from the browser, and add it to the headers in Postman.")]),t._v(" "),s("p",[t._v("After successfully logging in to our app in the browser, open up the developer tools and go to the Application tab. You should see our session under Cookies, with the default id "),s("code",[t._v("connect.sid")]),t._v(".")]),t._v(" "),s("p",[s("img",{attrs:{src:a(306),alt:"developer tools"}})]),t._v(" "),s("p",[t._v("We can copy this session id, and add it to our headers in Postman. And just like that, we are now signed in!")]),t._v(" "),s("p",[s("img",{attrs:{src:a(307),alt:"Postman Headers"}})])],1)}),[],!1,null,null,null);s.default=e.exports}}]);
<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Week 3: APIs | MAD9124</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Full-stack: API Development">
    
    <link rel="preload" href="/w2023/assets/css/0.styles.9d277d19.css" as="style"><link rel="preload" href="/w2023/assets/js/app.a268f35f.js" as="script"><link rel="preload" href="/w2023/assets/js/3.30d56026.js" as="script"><link rel="preload" href="/w2023/assets/js/8.5b458cb5.js" as="script"><link rel="preload" href="/w2023/assets/js/16.1e8637e4.js" as="script"><link rel="preload" href="/w2023/assets/js/17.feedfd9c.js" as="script"><link rel="prefetch" href="/w2023/assets/js/10.b7c1a16d.js"><link rel="prefetch" href="/w2023/assets/js/11.f2aecf7a.js"><link rel="prefetch" href="/w2023/assets/js/12.7642e84c.js"><link rel="prefetch" href="/w2023/assets/js/13.5e27a08c.js"><link rel="prefetch" href="/w2023/assets/js/14.4b92b91c.js"><link rel="prefetch" href="/w2023/assets/js/15.628eb87b.js"><link rel="prefetch" href="/w2023/assets/js/18.4d23c18f.js"><link rel="prefetch" href="/w2023/assets/js/19.bdc3f6f0.js"><link rel="prefetch" href="/w2023/assets/js/2.c49fd8f9.js"><link rel="prefetch" href="/w2023/assets/js/20.7bb0ba89.js"><link rel="prefetch" href="/w2023/assets/js/21.bbf158ab.js"><link rel="prefetch" href="/w2023/assets/js/22.04ba04d6.js"><link rel="prefetch" href="/w2023/assets/js/23.b3f8222f.js"><link rel="prefetch" href="/w2023/assets/js/24.74d3f93b.js"><link rel="prefetch" href="/w2023/assets/js/25.5343cc2e.js"><link rel="prefetch" href="/w2023/assets/js/26.9f73a8bf.js"><link rel="prefetch" href="/w2023/assets/js/27.45bceba5.js"><link rel="prefetch" href="/w2023/assets/js/28.3f49100e.js"><link rel="prefetch" href="/w2023/assets/js/29.dff6b604.js"><link rel="prefetch" href="/w2023/assets/js/30.0d01a8e4.js"><link rel="prefetch" href="/w2023/assets/js/31.cfbc8e9f.js"><link rel="prefetch" href="/w2023/assets/js/32.2bd8381f.js"><link rel="prefetch" href="/w2023/assets/js/33.c0fa7e80.js"><link rel="prefetch" href="/w2023/assets/js/34.a29cefed.js"><link rel="prefetch" href="/w2023/assets/js/35.26354f67.js"><link rel="prefetch" href="/w2023/assets/js/36.5d697666.js"><link rel="prefetch" href="/w2023/assets/js/37.19db9f95.js"><link rel="prefetch" href="/w2023/assets/js/38.388e9638.js"><link rel="prefetch" href="/w2023/assets/js/39.aa1380a5.js"><link rel="prefetch" href="/w2023/assets/js/4.c0130289.js"><link rel="prefetch" href="/w2023/assets/js/40.1e348976.js"><link rel="prefetch" href="/w2023/assets/js/5.9d721531.js"><link rel="prefetch" href="/w2023/assets/js/6.fec5c1cc.js"><link rel="prefetch" href="/w2023/assets/js/7.054fdd44.js"><link rel="prefetch" href="/w2023/assets/js/9.2198ac92.js">
    <link rel="stylesheet" href="/w2023/assets/css/0.styles.9d277d19.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/w2023/" class="home-link router-link-active"><!----> <span class="site-name">MAD9124</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/w2023/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/w2023/modules/" class="nav-link router-link-active">
  Modules
</a></div><div class="nav-item"><a href="/w2023/deliverables/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/w2023/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/w2023/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/w2023/modules/" class="nav-link router-link-active">
  Modules
</a></div><div class="nav-item"><a href="/w2023/deliverables/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/w2023/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Introduction</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Content Modules</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/w2023/modules/" aria-current="page" class="sidebar-link">Table of contents</a></li><li><a href="/w2023/modules/week1/" class="sidebar-link">Week 1: Introduction &amp; Review</a></li><li><a href="/w2023/modules/week2/" class="sidebar-link">Week 2: Node Modules &amp; Express</a></li><li><a href="/w2023/modules/week3/" aria-current="page" class="active sidebar-link">Week 3: APIs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#agenda" class="sidebar-link">Agenda</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#application-architecture" class="sidebar-link">Application Architecture</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#what-is-an-api" class="sidebar-link">What is an API?</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#what-is-a-web-service" class="sidebar-link">What is a Web Service?</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#client-server-architecture" class="sidebar-link">Client-Server Architecture</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#mvc-design-pattern" class="sidebar-link">MVC Design Pattern</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#clean-code" class="sidebar-link">Clean code</a></li></ul></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#restful-web-services" class="sidebar-link">RESTful Web Services</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#definitions" class="sidebar-link">Definitions</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#resource-data-model" class="sidebar-link">Resource / Data Model</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#api-endpoint" class="sidebar-link">API Endpoint</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#map-http-to-crud" class="sidebar-link">Map HTTP to CRUD</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#response-codes" class="sidebar-link">Response Codes</a></li></ul></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#restful-express" class="sidebar-link">RESTful Express</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#route-parameters" class="sidebar-link">Route Parameters</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#route-prefix" class="sidebar-link">Route Prefix</a></li></ul></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#testing-with-postman" class="sidebar-link">Testing with Postman</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#ex3-1-express-crud" class="sidebar-link">EX3-1 Express CRUD</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#prepare-a-week3-project-folder" class="sidebar-link">Prepare a week3 project folder</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#_1-list-the-cars-collection" class="sidebar-link">1. List the cars collection</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#_2-retrieve-a-single-car-object" class="sidebar-link">2. Retrieve a single car object</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#_3-create-a-new-car-object" class="sidebar-link">3. Create a new car object</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#_4-update-replace-an-object" class="sidebar-link">4. Update (replace) an object</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#_5-update-partial-an-object" class="sidebar-link">5. Update (partial) an object</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#_6-delete-an-object" class="sidebar-link">6. Delete an object</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#submit" class="sidebar-link">Submit</a></li></ul></li><li class="sidebar-sub-header"><a href="/w2023/modules/week3/#for-next-week" class="sidebar-link">For next week</a></li></ul></li><li><a href="/w2023/modules/week4/" class="sidebar-link">Week 4: Building RESTful APIs with Express</a></li><li><a href="/w2023/modules/week5/" class="sidebar-link">Week 5: Asynchronous Programming</a></li><li><a href="/w2023/modules/week6/" class="sidebar-link">Week 6: Middleware</a></li><li><a href="/w2023/modules/week7/" class="sidebar-link">Week 7: Midterm Project</a></li><li><a href="/w2023/modules/break-week/" class="sidebar-link">Break Week</a></li><li><a href="/w2023/modules/week9/" class="sidebar-link">Week 9: Data Persitance and MongoDB</a></li><li><a href="/w2023/modules/week10/" class="sidebar-link">Week 10: Object Data Modelling with Mongoose</a></li><li><a href="/w2023/modules/week11/" class="sidebar-link">Week 11: Authentication With Passport</a></li><li><a href="/w2023/modules/week12/" class="sidebar-link">Week 12: Data Santization, XSS and LoggingS</a></li><li><a href="/w2023/modules/week13/" class="sidebar-link">Week 13: Testing with Jest</a></li><li><a href="/w2023/modules/week14/" class="sidebar-link">Week 14: Preparing for Production</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1><span class="week">Week 3</span><br> <span class="title">Application Architecture and RESTful APIs</span></h1> <h2 id="agenda"><a href="#agenda" class="header-anchor">#</a> Agenda</h2> <ul><li>AMA (15 min)</li> <li>Application Architecture (20 min)</li> <li>RESTful Web Services (10 min)</li> <li>RESTful Express (10 min)
<ul><li>CRUD Routes</li> <li>Route Parameters</li></ul></li> <li>Break (10 min)</li> <li>Testing with POSTMAN</li> <li>Install Postman</li> <li>EX3-1 Express CRUD</li></ul> <h2 id="application-architecture"><a href="#application-architecture" class="header-anchor">#</a> Application Architecture</h2> <p><strong>Web services, web APIs, REST APIs, RESTful web APIs ... what does it all mean?</strong></p> <h3 id="what-is-an-api"><a href="#what-is-an-api" class="header-anchor">#</a> What is an API?</h3> <blockquote><p>An application program interface (API) is code that allows two software programs to communicate with each other. The API defines the correct way for a developer to write a program that requests services from an operating system (OS) or other application. APIs are implemented by function calls composed of verbs and nouns. The required syntax is described in the documentation of the application being called.</p></blockquote> <p>An <a href="https://searchmicroservices.techtarget.com/definition/application-program-interface-API" target="_blank" rel="noopener noreferrer">Application Programming Interface<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (API) is often thought of as a contract that describes a predictable method of accessing the data or functions implemented by another program or module. The shape of the data provided and the <a href="https://developer.mozilla.org/en-US/docs/Glossary/Signature/Function" target="_blank" rel="noopener noreferrer">function signatures<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> remain constant, even if the underlying implementation changes.</p> <h3 id="what-is-a-web-service"><a href="#what-is-a-web-service" class="header-anchor">#</a> What is a Web Service?</h3> <p>A web service is a software architectural pattern that exposes an API for remotely manipulating collections of resources via the stateless HTTP communications protocol.</p> <p>Definition from Wikipedia</p> <blockquote><p>In a web service, the Web technology such as HTTP—originally designed for human-to-machine communication—is utilized for machine-to-machine communication, more specifically for transferring machine-readable file formats such as XML and JSON.</p></blockquote> <blockquote><p>In practice, a web service commonly provides an object-oriented web-based interface to a database server, utilized for example by another web server, or by a mobile app, that provides a user interface to the end user.</p></blockquote> <h3 id="client-server-architecture"><a href="#client-server-architecture" class="header-anchor">#</a> Client-Server Architecture</h3> <p>Web service are built on the broader client server architectural pattern which has a long history going back to the development of <a href="https://en.wikipedia.org/wiki/ARPANET" target="_blank" rel="noopener noreferrer">ARPANET<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> in late 1960s. The core premise is that the responsibilities for various aspects of an application are separated, with some running on the client computers and some running on the centralized server. Clients could be desktop applications, native mobile applications, web applications, or hybrid applications.</p> <p>The main benefits to this architectural model have changed over time, but it is still the prevailing choice for building modern applications. In the context of mobile application development, this allows for a <strong>single source of truth</strong> - meaning that no matter how many clients are using our application, the data is stored in one place and we will have data consistency across all clients.</p> <p>The typical division of responsibilities has the client manage the presentation of data, user interaction events and navigation. The server is responsible for authentication, data validation and storage.</p> <p><img src="/w2023/assets/img/client-server.bf583183.jpeg" alt="architecture diagram"></p> <p>How much application logic resides on the client v.s. the server has shifted over time, with the trend toward pushing more application logic out to the client.</p> <p><img src="/w2023/assets/img/web-app-evolution.522997b1.jpeg" alt="evolution of web applications"></p> <h3 id="mvc-design-pattern"><a href="#mvc-design-pattern" class="header-anchor">#</a> MVC Design Pattern</h3> <p>There are many design patterns for building an application in the client-server architectural style. The most common for web and mobile apps is the <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller" target="_blank" rel="noopener noreferrer">Model View Controller<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (MVC) pattern and it derivatives such as <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel" target="_blank" rel="noopener noreferrer">Model View View-model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (MVVM).</p> <p>Organizing our code in this way allows us to break the application problem space down into smaller chunks each with specific areas of responsibility. This makes it easier to reason about our code and automate testing.</p> <p>The MVC pattern divides responsibilities along these lines ...</p> <p><strong>Model</strong>: data objects
<img src="/w2023/assets/img/mvc.85e01f97.jpeg" style="float:right;width:50%;"></p> <p>Model classes define the data shape (what properties an object has) and the business rules that affect data validation and behavioural capabilities. They also manage the object instance life cycle - the persistence and retrieval of data from a permanent storage location such as a database.</p> <p><strong>Controller</strong>: data request handling</p> <p>These modules are the traffic cops of our applications. They define the route handlers for a web service's API endpoints. They will be responsible for ensuring that the user is authorized to make the request and that any data passed meets the validation requirements, before invoking the appropriate Model modules.</p> <p>Controller modules are also responsible for correctly formatting the response data payload.</p> <p><strong>View</strong>: user interface / presentation</p> <p>View components receive response data from the controller modules and manage the display of that data in the user interface. They also respond to user interaction events and collect any new or updated data that needs to be forwarded to the controller for processing.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>This course will focus on building the Model and Controller elements of the MCV pattern.</p></div> <h3 id="clean-code"><a href="#clean-code" class="header-anchor">#</a> Clean code</h3> <p>As we build out our in-class examples and assignments throughout the remainder of this course. I will try to exemplify some of the 'Clean Code' best practice recommendations, with a particular focus on <strong>naming rules</strong>, <strong>function rules</strong>, <strong>comment rules</strong> and <strong>code structure</strong>.</p> <blockquote><p>Code is clean if it can be understood easily – by everyone on the team. Clean code can be read and enhanced by a developer other than its original author. With understandability comes readability, changeability, extensibility and maintainability.</p></blockquote> <p><a href="https://medium.com/mindorks/how-to-write-clean-code-lessons-learnt-from-the-clean-code-robert-c-martin-9ffc7aef870c" target="_blank" rel="noopener noreferrer">Lessons learnt from “Clean Code”  —  Robert C. Martin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://gist.github.com/wojteklu/73c6914cc446146b8b533c0988cf8d29" target="_blank" rel="noopener noreferrer">Summary of 'Clean code' by Robert C. Martin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://en.wikipedia.org/wiki/Robert_C._Martin" target="_blank" rel="noopener noreferrer">Uncle Bob Martin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> has written many books over the years - not all of them an easy read, but <em>Clean code : a handbook of agile software craftsmanship</em> (available in the Algonquin College Library) should be on every professional developer's (re)reading list. As you progress through your career, you will get new insights from revisiting this text.</p> <h2 id="restful-web-services"><a href="#restful-web-services" class="header-anchor">#</a> RESTful Web Services</h2> <div class="custom-block tip"><p class="custom-block-title">History of REST</p> <p>The REST architectural style was created by <a href="https://en.wikipedia.org/wiki/Roy_Fielding" target="_blank" rel="noopener noreferrer">Roy Fielding<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> in parallel with the development of the HTTP v1.1 protocol from 1996 - 1999. Fielding outlined the principles and constraints of a RESTfull web service in his PhD dissertation published in 2000.</p></div> <p>OK, we know what an API is and that web services are a way to expose an API over the internet using the same protocols as web browsers. So, what about RESTful APIs or RESTful web services?</p> <p>RESTful web services are web services that follow the Representational State Transfer (REST) architectural style by exposing an API that defines all actions with respect to a given resource URI organized to correspond to one of the standard <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete" target="_blank" rel="noopener noreferrer">C.R.U.D.<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> operations mapped to the HTTP verbs.</p> <p>Let's unpack that into smaller pieces, starting with a review of some helpful definitions.</p> <h3 id="definitions"><a href="#definitions" class="header-anchor">#</a> Definitions</h3> <ul><li><strong>REST</strong>: <a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="noopener noreferrer">Representational state transfer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><strong>JSON</strong>: <a href="https://en.wikipedia.org/wiki/JSON" target="_blank" rel="noopener noreferrer">JavaScript Object Notation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><strong>Resource</strong>: A class of data objects</li> <li><strong>Resource Path</strong>: The path portion of the <a href="https://en.wikipedia.org/wiki/Uniform_Resource_Identifier" target="_blank" rel="noopener noreferrer">URI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><strong>Endpoint</strong>: The full URI including the path</li> <li><strong>Route</strong>: The combination of the resource path and the HTTP verb</li> <li><strong>CRUD</strong>: Create, Read, Update, Delete</li></ul> <h3 id="resource-data-model"><a href="#resource-data-model" class="header-anchor">#</a> Resource / Data Model</h3> <p>A core concept in this API design pattern is creating representational data models to define the properties and methods for discrete object components in an application. We refer to these objects as <em>resources</em> or <em>collections</em> of resources.</p> <p>Suppose that we were building an attendance tracking application. As we think about the problem, two obvious object types (or resources) come to mind:</p> <ul><li>students</li> <li>classes</li></ul> <p>Our application would need to keep track of these objects and how they related to each other. We will dig into this topic in more detail in weeks 5 and 6.</p> <h3 id="api-endpoint"><a href="#api-endpoint" class="header-anchor">#</a> API Endpoint</h3> <p>Because we will be using HTTP to act on these resources, we typically construct our URIs using the collective noun form of each resource type as the path. If our fictional application were hosted with the hostname <code>api</code> on the domain name <code>attendance.io</code>, the URI for the <code>students</code> collection resource would be</p> <p><img src="/w2023/assets/img/uri.57075a0a.jpeg" alt="https://api.attendance.io/students"></p> <div class="custom-block warning"><p class="custom-block-title">Port number is optional</p> <p>If it is omitted, the default port for the scheme will be used.</p></div> <br> <h3 id="map-http-to-crud"><a href="#map-http-to-crud" class="header-anchor">#</a> Map HTTP to CRUD</h3> <table><thead><tr><th style="text-align:left;">CRUD Action</th> <th style="text-align:left;">HTTP Verb</th> <th style="text-align:left;">Resource Path</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;">Create</td> <td style="text-align:left;">POST</td> <td style="text-align:left;">/students</td> <td style="text-align:left;">Create a new member of the resource collection</td></tr> <tr><td style="text-align:left;">Read</td> <td style="text-align:left;">GET</td> <td style="text-align:left;">/students</td> <td style="text-align:left;">Retrieve the entire resource collection (results may be paginated)</td></tr> <tr><td style="text-align:left;">Read</td> <td style="text-align:left;">GET</td> <td style="text-align:left;">/students/1</td> <td style="text-align:left;">Retrieve a specific member of the collection if the path includes a unique identifier segment</td></tr> <tr><td style="text-align:left;">Update</td> <td style="text-align:left;">PUT</td> <td style="text-align:left;">/students/1</td> <td style="text-align:left;">Replace all properties of a given member of the resource collection</td></tr> <tr><td style="text-align:left;">Update</td> <td style="text-align:left;">PATCH</td> <td style="text-align:left;">/students/1</td> <td style="text-align:left;">Update certain properties of a given member of the resource collection</td></tr> <tr><td style="text-align:left;">Delete</td> <td style="text-align:left;">DELETE</td> <td style="text-align:left;">/students/1</td> <td style="text-align:left;">Remove a given member from the resource collection</td></tr></tbody></table> <div class="custom-block warning"><p class="custom-block-title">Clarification</p> <p>Some of the example resource paths above use the unique resource identifier <code>1</code>. This is just an example. You would replace <code>1</code> with the correct id value for the desired member of the collection that you wish to act upon.</p></div> <h3 id="response-codes"><a href="#response-codes" class="header-anchor">#</a> Response Codes</h3> <p>For each client request received by the server a response should be sent. Included in the header information of that response is a status code. The most common response codes used with RESTful web services are:</p> <table><thead><tr><th style="text-align:right;">Code</th> <th style="text-align:left;">Message</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:right;">200</td> <td style="text-align:left;">OK</td> <td style="text-align:left;">The request has succeeded.</td></tr> <tr><td style="text-align:right;">201</td> <td style="text-align:left;">Created</td> <td style="text-align:left;">The request has succeeded and a new resource has been created as a result of it. This is typically the response sent after a POST request, or after some PUT requests.</td></tr> <tr><td style="text-align:right;">400</td> <td style="text-align:left;">Bad Request</td> <td style="text-align:left;">The server cannot or will not process the request due to something that is perceived to be a client error. This includes resource object property validation errors.</td></tr> <tr><td style="text-align:right;">401</td> <td style="text-align:left;">Unauthorized</td> <td style="text-align:left;">Although the HTTP standard specifies &quot;unauthorized&quot;, semantically this response means &quot;unauthenticated&quot;. That is, the client must authenticate itself to get the requested response.</td></tr> <tr><td style="text-align:right;">403</td> <td style="text-align:left;">Forbidden</td> <td style="text-align:left;">The client does not have access rights to the content, i.e. they are unauthorized, so server is rejecting to give proper response. Unlike 401, the client's identity is known to the server.</td></tr> <tr><td style="text-align:right;">404</td> <td style="text-align:left;">Not found</td> <td style="text-align:left;">The server can not find requested resource. In the browser, this means the URL is not recognized. In an API, this can also mean that the endpoint is valid but the resource itself does not exist.</td></tr> <tr><td style="text-align:right;">418</td> <td style="text-align:left;">I'm a teapot</td> <td style="text-align:left;">Error response code indicates that the server refuses to brew coffee because it is, permanently, a teapot. This error is a reference to Hyper Text Coffee Pot Control Protocol defined in April Fools' jokes in 1998 and 2014.</td></tr> <tr><td style="text-align:right;">429</td> <td style="text-align:left;">Too many requests</td> <td style="text-align:left;">The user has sent too many requests in a given amount of time (&quot;rate limiting&quot;).</td></tr> <tr><td style="text-align:right;">500</td> <td style="text-align:left;">Internal server error</td> <td style="text-align:left;">The server has encountered a situation it doesn't know how to handle. For example, the application server cannot communicate with the database.</td></tr></tbody></table> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>You may still see some web services responding with status code 422 (unprocessable entity) for data validation errors. This used to be quite common. However, the current standards compliant best practice is to use status code 400.</p></div> <p>The full list of <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" target="_blank" rel="noopener noreferrer">standard HTTP response codes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is detailed on the MDN Web Docs site.</p> <h2 id="restful-express"><a href="#restful-express" class="header-anchor">#</a> RESTful Express</h2> <p>The Express framework for Node.js makes it easy to define RESTful route handlers. The Express <code>app</code> object has convenient methods that correspond to each of the HTTP verbs. So, for a given resource path like <code>/api/cars</code> from last week's exercise, we can define a full set of CRUD route handlers like this ...</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/cars/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// return a collection of cars</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// return the car matching the id value</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/cars/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// create a new car</span>
app<span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// update some properties of a car</span>
app<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// replace all properties of a car</span>
app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// destroy the record for a car</span>
</code></pre></div><p>Here's an another example of a RESTful API that allows for creating, reading, updating, and deleting Pokemon:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">GET</span>    <span class="token operator">/</span>pokemon                # Retrieve a list <span class="token keyword">of</span> all pokemon
<span class="token constant">GET</span>    <span class="token operator">/</span>pokemon<span class="token operator">/</span><span class="token operator">:</span>id            # Retrieve a specific pokemon by <span class="token constant">ID</span>
<span class="token constant">POST</span>   <span class="token operator">/</span>pokemon                # Create a <span class="token keyword">new</span> <span class="token class-name">pokemon</span>
<span class="token constant">PUT</span>    <span class="token operator">/</span>pokemon<span class="token operator">/</span><span class="token operator">:</span>id            # Update an existing pokemon
<span class="token constant">DELETE</span> <span class="token operator">/</span>pokemon<span class="token operator">/</span><span class="token operator">:</span>id            # Delete a specific pokemon by <span class="token constant">ID</span>
</code></pre></div><p>The <code>GET /pokemon</code> endpoint returns a list of all Pokemon, the <code>GET /pokemon/:id</code> endpoint returns a specific Pokemon by ID, <code>POST /pokemon</code> endpoint create a new Pokemon, <code>PUT /pokemon/:id</code> endpoint update an existing Pokemon, <code>DELETE /pokemon/:id</code> endpoint delete a specific Pokemon by ID.</p> <p>It's worth noting that this is just one example and it can be extended or customized to suit the needs of your application.</p> <p>Also, it's important to have a data source to store the Pokemon, a database (SQL or NoSQL) or even an in-memory data source.</p> <p>Additionally, you need to implement the logic to handle the CRUD operations on the data source, this can be achieved by using a web framework such as Express.js for Node.js, Flask for Python, or Spring for Java.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The <code>post()</code>, <code>patch()</code>, and <code>put()</code> methods all expect a JSON object in the request body. We need to tell our Express app how to parse the request body.</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></div> <h3 id="route-parameters"><a href="#route-parameters" class="header-anchor">#</a> Route Parameters</h3> <p>In order to apply actions to specific members of a resource collection, we need to be able to capture their unique id from the resource path of the URI. Express makes this simple. <a href="https://expressjs.com/en/guide/routing.html#route-parameters" target="_blank" rel="noopener noreferrer">From the docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ...</p> <blockquote><p>Route parameters are named URL segments that are used to capture the values specified at their position in the URL. The captured values are populated in the <code>request.params</code> object, with the name of the route parameter specified in the path as their respective keys.</p></blockquote> <p>In our route handler functions, we can access the named route parameters via the <code>params</code> property of the <code>request</code> object. In the example routes above we have <code>/cars/:id</code>. The “id” property is available as <code>request.params.id</code>.</p> <p>The <code>request.params</code> object defaults to <code>{}</code> (an empty object) if there are no route parameters defined.</p> <h3 id="route-prefix"><a href="#route-prefix" class="header-anchor">#</a> Route Prefix</h3> <p>To simplify our code and reduce the opportunity for typos in the route path, we can use the <code>app.route()</code> method to get a route object and then chain our HTTP verb methods onto that.</p> <div class="language-js extra-class"><pre class="language-js"><code>app
  <span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">'/api/cars'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

app
  <span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:id'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="testing-with-postman"><a href="#testing-with-postman" class="header-anchor">#</a> Testing with Postman</h2> <p>Postman is a fantastic tool to assist in developing web service APIs. At the simplest level it is a special HTTP client that let's us easily manipulate the header and body content to test API endpoints. We can also use JavaScript to automate some of our tests.</p> <p>Postman has an extremely rich set of capability to help throughout the full development lifecycle. You can see the promotional video to get an idea.</p> <p>Additionally, Postman also allows you to save your requests in a collection and you can also create test scripts using javascript to automate the testing process, which makes it easy to test your API endpoints repeatedly and quickly.</p> <p>It's also worth noting that Postman also allows you to set up environment variables that can be used to store and reuse values such as API keys and URLs.</p> <iframe width="740" height="416" src="https://www.youtube.com/embed/VxY_cz0VQXE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe> <p>We will be using Postman throughout the course as part of our testing regimen. We will start today with manual testing of our Express route handlers.</p> <p><a href="https://www.getpostman.com/" target="_blank" rel="noopener noreferrer">Download Postman<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and run the installer.</p> <h2 id="ex3-1-express-crud"><a href="#ex3-1-express-crud" class="header-anchor">#</a> EX3-1 Express CRUD</h2> <p>Let's take the example routes above and make them functional.</p> <h3 id="prepare-a-week3-project-folder"><a href="#prepare-a-week3-project-folder" class="header-anchor">#</a> Prepare a <code>week3</code> project folder</h3> <p>In you MAD9124 Repository, navigate to your week3 directory.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> week3
</code></pre></div><p>Create a new folder called exercise-3 and add the boilerplates.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">mkdir</span> exercise-3
<span class="token builtin class-name">cd</span> exercise-3

<span class="token builtin class-name">echo</span> <span class="token string">&quot;.DS_Store<span class="token entity" title="\n">\n</span>node_modules/&quot;</span> <span class="token operator">&gt;</span> .gitignore
<span class="token builtin class-name">echo</span> <span class="token string">&quot;'use strict'&quot;</span> <span class="token operator">&gt;</span> app.js
</code></pre></div><p>Open the project folder in your code editor.</p> <div class="language-sh extra-class"><pre class="language-sh"><code>code <span class="token builtin class-name">.</span>
</code></pre></div><p>Initilize npm and install express.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> init
<span class="token comment"># follow the prompts to create you package.json file</span>
<span class="token function">npm</span> <span class="token function">install</span> express
</code></pre></div><p>Create a <code>cars.js</code> file and let's add hard coded array of car objects.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> cars <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">make</span><span class="token operator">:</span> <span class="token string">'Tesla'</span><span class="token punctuation">,</span> <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token string">'S'</span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token string">'Black'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">make</span><span class="token operator">:</span> <span class="token string">'Tesla'</span><span class="token punctuation">,</span> <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token string">'Red'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token literal-property property">make</span><span class="token operator">:</span> <span class="token string">'Tesla'</span><span class="token punctuation">,</span> <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token string">'X'</span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token string">'Silver'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token literal-property property">make</span><span class="token operator">:</span> <span class="token string">'Tesla'</span><span class="token punctuation">,</span> <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token string">'Y'</span><span class="token punctuation">,</span> <span class="token literal-property property">colour</span><span class="token operator">:</span> <span class="token string">'Chestnut Brown'</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p>Stub out the <code>app.js</code> file.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span>

<span class="token keyword">const</span> cars <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./cars.js'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/cars'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:carId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/cars'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:carId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:carId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:carId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>port <span class="token operator">||</span> <span class="token number">3030</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Server listening on port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ...</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The <code>process.env.port</code> reference above is checking if we have defined a value for the port in an environment variable. If it exists that value will be assigned to our application's <code>port</code> variable. Otherwise, the default value of <code>3030</code> will be assigned.</p> <p>We will talk more about using environment variables to customize our Node app in the course module on Production Deployment.</p></div> <h3 id="_1-list-the-cars-collection"><a href="#_1-list-the-cars-collection" class="header-anchor">#</a> 1. List the cars collection</h3> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/cars'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">data</span><span class="token operator">:</span> cars<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>Now lets test it with Postman. We need to create a new <code>get</code> request in Postman with the URI of our route above: <code>localhost:3030/api/cars</code></p> <p>Because it is a simple get request, we don't need to specify any other details. Just go ahead and click the big blue [Send] button, and then look at the returned results in the lower portion of the screen.</p> <p><img src="/w2023/assets/img/screenshot-postman-get-cars.f00a1802.png" alt="screenshot"></p> <p>This returns the entire collection of car objects as an array. In later modules you will learn how to break up very large result sets into chunks using pagination.</p> <h3 id="_2-retrieve-a-single-car-object"><a href="#_2-retrieve-a-single-car-object" class="header-anchor">#</a> 2. Retrieve a single car object</h3> <p>When we know that we are only interested in one particular resource object, and we know it's unique identifier, we append the object's id value to the route e.g. <code>/api/cars/3</code>. In our route handler function we will use that <code>carId</code> parameter to find and return the requested object.</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:carId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> car <span class="token operator">=</span> cars<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">car</span> <span class="token operator">=&gt;</span> car<span class="token punctuation">.</span>id <span class="token operator">===</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>carId<span class="token punctuation">)</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">data</span><span class="token operator">:</span> car<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Notice that we need to use the <code>parseInt()</code> function because all parameter values from the HTTP URI are processed with the type <code>string</code> and we want to compare it to a <code>number</code>.</p></div> <p>OK. Test it with Postman.</p> <p><img src="/w2023/assets/img/screenshot-postman-get-cars-3.a568c2fb.png" alt="screenshot"></p> <h3 id="_3-create-a-new-car-object"><a href="#_3-create-a-new-car-object" class="header-anchor">#</a> 3. Create a new car object</h3> <p>To create a new resource object we use the base collection route (e.g. <code>/api/cars</code>) but with the HTTP verb <code>POST</code>. We pass the details for the object that we want to create as a JSON document in the body of the request. Remember earlier we told Express to parse the request body as JSON with the <code>app.use(express.json())</code> directive.</p> <p>We will talk about more robust data validation in later modules, but for now we will simply extract the object properties that we know we need from the request body and create a new unique id using the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/now" target="_blank" rel="noopener noreferrer">Date.now()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> method to get an integer representing the number of milliseconds since midnight on January 1st, 1970. There are better ways to generate a unique id but this will do for now.</p> <p>Now we have all of the data properties for our new car object and we can use the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/push" target="_blank" rel="noopener noreferrer">array.push()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> method to add the new object to our collection.</p> <p>Lastly, we need to return the newly created object back to the requesting client. Express will use the <code>200</code> status code by default, which is OK, but it is a better practice to send a <code>201 Created</code> status when successfully processing a create request. Chain on the <code>res.status(201)</code> method before the <code>send()</code> method.</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/cars'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> colour<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body
  <span class="token keyword">const</span> newCar <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    make<span class="token punctuation">,</span>
    model<span class="token punctuation">,</span>
    colour
  <span class="token punctuation">}</span>
  cars<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newCar<span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">data</span><span class="token operator">:</span> newCar<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>OK. Test it with Postman.</p> <ul><li>Create a new request tab.</li> <li>Set the type to POST with the same URI: <code>localhost:3030/api/cars</code></li> <li>Under the URI box select the <code>body</code> tab</li> <li>Under body, select the <code>raw</code> type</li> <li>From the dropdown menu at the end of that row, select <code>JSON (application/json)</code></li> <li>Create the JSON document in the large text box in the middle of the screen.</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;make&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Tesla&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;model&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Semi&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;colour&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Silver&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>Click the blue send button</li></ul> <p><img src="/w2023/assets/img/screenshot-postman-post.28400b6d.png" alt="screenshot"></p> <h3 id="_4-update-replace-an-object"><a href="#_4-update-replace-an-object" class="header-anchor">#</a> 4. Update (replace) an object</h3> <p>There are two methods of updating a resource object: replace and patch. Let's look at the replace method first.</p> <p>It is similar to the create method, but uses the HTTP verb <code>PUT</code> rather than <code>POST</code>. The request body contains a JSON document with the complete resource object. The URI includes the id in the path just like the <code>GET</code> request.</p> <p>Our route handler function will extract the object properties and update the collection.</p> <p>Get the target object's id from the <code>req.params</code>, so that we can find the index of that object in our collection array. The <code>array.findIndex()</code> method works similarly to the <code>array.find()</code> method, but returns the array index of the matching element rather than the element itself.</p> <p>Following the happy path (no errors), we will extract the resource properties from the <code>req.body</code>, excluding the <code>id</code> property. <strong>The client should never be allowed to change the unique id of an object.</strong> Using these properties and the <code>carId</code> from the <code>req.params</code>, construct a new resource object and assign it to the collection index position of the old object. Finally return the updated object with a <code>200</code> status code.</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:carId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>carId<span class="token punctuation">)</span>
  <span class="token keyword">const</span> index <span class="token operator">=</span> cars<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">car</span> <span class="token operator">=&gt;</span> car<span class="token punctuation">.</span>id <span class="token operator">===</span> id<span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> colour<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body
  <span class="token keyword">const</span> updatedCar <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> colour<span class="token punctuation">}</span>
  cars<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> updatedCar
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">data</span><span class="token operator">:</span> updatedCar<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>But, what if the client sent a request with an invalid resource id?</p> <p>We need to check if we found a valid index. The <code>findIndex()</code> method returns a value of <code>-1</code> if there was no match and we should send a <code>404 error</code> response. Our request handler should now look like this ...</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:carId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>carId<span class="token punctuation">)</span>
  <span class="token keyword">const</span> index <span class="token operator">=</span> cars<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">car</span> <span class="token operator">=&gt;</span> car<span class="token punctuation">.</span>id <span class="token operator">===</span> id<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">errors</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">'Not found'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token string">'404'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'Resource does not exist'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">We could not find a car with id: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> colour<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body
    <span class="token keyword">const</span> updatedCar <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> colour<span class="token punctuation">}</span>
    cars<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> updatedCar
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">data</span><span class="token operator">:</span> updatedCar<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The format of the <code>errors</code> return value follows the best practice described in the JSON:API specification, which we will look at in more detail in week 9.</p></div> <p>OK. Test it with Postman.</p> <ul><li>duplicate the current request tab</li> <li>change the method to <code>PUT</code></li> <li>resubmit the <code>POST</code> request</li> <li>copy the id from the response body of the POST request and add it to the URI</li> <li>edit the JSON body to change the colour to <code>Sunburst Orange</code></li> <li>click the blue send button</li></ul> <p><img src="/w2023/assets/img/screenshot-postman-put.5dc14808.png" alt="screenshot"></p> <h3 id="_5-update-partial-an-object"><a href="#_5-update-partial-an-object" class="header-anchor">#</a> 5. Update (partial) an object</h3> <p>In a partial update, the client constructs the request body with only the properties that have changed for a given object. The request URI is the same as the <code>PUT</code> method, the HTTP verb is changed to <code>PATCH</code>.</p> <p>Start by copying the code from the <code>PUT</code> request handler. We will change the first two lines in the <code>else</code> block.</p> <p>First let's change how we extract the object properties from the <code>req.body</code>. We will use JavaScript's <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Rest_in_Object_Destructuring" target="_blank" rel="noopener noreferrer">Rest operator in object destructuring<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. This means we can isolate the <code>id</code> property if it is included in the <code>req.body</code> and stuff all of the remaining properties into a new object variable (every so cleverly named <code>theRest</code> in this example).</p> <p>The second trick is to use the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" target="_blank" rel="noopener noreferrer">Object.assign()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> function to merge the old car object with the updated properties contained in our <code>theRest</code> variable.</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token string">'/api/cars/:carId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>carId<span class="token punctuation">)</span>
  <span class="token keyword">const</span> index <span class="token operator">=</span> cars<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">car</span> <span class="token operator">=&gt;</span> car<span class="token punctuation">.</span>id <span class="token operator">===</span> id<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">errors</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">'Not found'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token string">'404'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'Resource does not exist'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">We could not find a car with id: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> <span class="token operator">...</span>theRest<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body
    <span class="token keyword">const</span> updatedCar <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> cars<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> theRest<span class="token punctuation">)</span>
    cars<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> updatedCar
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">data</span><span class="token operator">:</span> updatedCar<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>OK. Test it with Postman.</p> <ul><li>duplicate the current request tab</li> <li>change the method to <code>PATCH</code></li> <li>resubmit the <code>POST</code> request</li> <li>copy the id from the response body of the POST request and add it to the URI</li> <li>edit the JSON body to change the colour to <code>Candy Apple Red</code></li> <li>click the blue send button</li></ul> <p><img src="/w2023/assets/img/screenshot-postman-patch.bd83251e.png" alt="screenshot"></p> <h3 id="_6-delete-an-object"><a href="#_6-delete-an-object" class="header-anchor">#</a> 6. Delete an object</h3> <p>OK. You have seen the pattern. Now complete this last one on your own.</p> <ul><li>The HTTP verb is DELETE</li> <li>A delete request has no request body</li> <li>Check to see if the carId parameter exists, send an error if not</li> <li>Find the index of the car object in the array</li> <li>Remove that one element from the array (<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice" target="_blank" rel="noopener noreferrer">hint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</li> <li>Return the removed object in the response</li></ul> <p>Test it with Postman. It should look like this ...</p> <p><img src="/w2023/assets/img/screenshot-postman-delete.20daa5e9.png" alt="screenshot"></p> <h3 id="submit"><a href="#submit" class="header-anchor">#</a> Submit</h3> <p>All work for this assigment should be completed in your private MAD9124 Github Repository that you have shared with me.</p> <p>Create a commit to include all of your work from today.</p> <p>Link the local repo to the GitHub repo and sync them up.</p> <p>Submit the GitHub repo's URL on Brightspace.</p> <h2 id="for-next-week"><a href="#for-next-week" class="header-anchor">#</a> For next week</h2> <p>Before next week's class, please read these additional online resources.</p> <ul><li><p><a href="http://javascript.info/object#cloning-and-merging-object-assign" target="_blank" rel="noopener noreferrer">JavaScript: Cloning and merging, Object.assign<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="http://javascript.info/destructuring-assignment" target="_blank" rel="noopener noreferrer">JavaScript: Destructuring assignment<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://hackernoon.com/restful-api-design-step-by-step-guide-2f2c9f9fcdbf" target="_blank" rel="noopener noreferrer">RESTful API Design — Step By Step Guide<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://expressjs.com/en/starter/basic-routing.html" target="_blank" rel="noopener noreferrer">Express Documentation: Basic Routing<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://blog.bitsrc.io/a-beginners-guide-to-server-side-web-development-with-node-js-17385da09f93" target="_blank" rel="noopener noreferrer">A Beginner’s Guide to Server-Side Web Development with Node.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://expressjs.com/en/guide/routing.html" target="_blank" rel="noopener noreferrer">Express Documentation: Routing Guide<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://medium.com/mindorks/how-to-write-clean-code-lessons-learnt-from-the-clean-code-robert-c-martin-9ffc7aef870c" target="_blank" rel="noopener noreferrer">Lessons learnt from “Clean Code”  —  Robert C. Martin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://www.youtube.com/watch?v=t5n07Ybz7yI" target="_blank" rel="noopener noreferrer">Introduction to Postman<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>video</span></p></li> <li><p><a href="https://www.youtube.com/watch?v=_LqgURg3BXw" target="_blank" rel="noopener noreferrer">How to use NPM<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>video</span></p></li> <li><p><a href="https://www.youtube.com/watch?v=P2LdhPpqSiU" target="_blank" rel="noopener noreferrer">What is JSON<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>video</span></p></li> <li><p><a href="https://www.youtube.com/watch?v=912_cPllMyg" target="_blank" rel="noopener noreferrer">JSON vs JS Objects<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>video</span></p></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/25/2023, 4:07:01 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/w2023/modules/week2/" class="prev">
        Week 2: Node Modules &amp; Express
      </a></span> <span class="next"><a href="/w2023/modules/week4/">
        Week 4: Building RESTful APIs with Express
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/w2023/assets/js/app.a268f35f.js" defer></script><script src="/w2023/assets/js/3.30d56026.js" defer></script><script src="/w2023/assets/js/8.5b458cb5.js" defer></script><script src="/w2023/assets/js/16.1e8637e4.js" defer></script><script src="/w2023/assets/js/17.feedfd9c.js" defer></script>
  </body>
</html>
